---
title: ğŸ’»[C#]IPC í†µì‹ íƒêµ¬ (Named Pipe)-3
date: 2024-05-27 +09:00
categories: [Tech, C#]
tags:
  [
  C#, IPC, SharedMemory
  ]
image : /assets/img/Cat/IPC_Cat.png

hidden : false
---

## ğŸ“š ê°œë°œ í™˜ê²½

* <img src="https://cdn3.emoji.gg/emojis/8574_visual_studio.png" alt="View" width="25" height="25"> VisualStudio 2022
* <img src="https://cdn3.emoji.gg/emojis/3846-dotnet.png" alt="View" width="25" height="25"> `.NET 6`
*  <img src="https://cdn3.emoji.gg/emojis/1739_CMD.png" alt="View" width="30" height="30">  `Console APP` 


## ğŸ“‘ NamedPipeServerStream

[NamedPipeServerStream](https://learn.microsoft.com/ko-kr/dotnet/api/system.io.pipes.namedpipeserverstream?view=net-6.0)
ë¨¼ì € NamePipeì˜ Server ë¶€ë¶„ì˜ ìƒì„±ìë¥¼ ë³´ë©´

<br>

```csharp
public NamedPipeServerStream (string pipeName, System.IO.Pipes.PipeDirection direction);
```
* `string pipeName` : íŒŒì´í”„ì˜ ì´ë¦„
* `System.IO.Pipes.PipeDirection direction` : íŒŒì´í”„ì˜ ë°©í–¥

<br>

ë°©í–¥ì˜ ì—´ê±° ê°’ì—ëŠ” ì´ 3ê°€ì§€ê°€ ìˆìœ¼ë©°

| Field   | Description                     |
| ------- | ------------------------------- |
| `In`    | íŒŒì´í”„ ë°©í–¥ì„ ì•ˆìª½ìœ¼ë¡œ ì§€ì •í•¨   |
| `InOut` | íŒŒì´í”„ ë°©í–¥ì„ ì–‘ìª½ìœ¼ë¡œ ì§€ì •í•¨   |
| `Out`   | íŒŒì´í”„ ë°©í–¥ì„ ë°”ê¹¥ìª½ìœ¼ë¡œ ì§€ì •í•¨ |

<br>

ì—¬ê¸°ì„œ  `Server` ìª½ì—ëŠ” `Out`ì„ ì“¸ê²ƒì´ë‹¤. 
í•´ë‹¹ íŒŒì´í”„ê°€ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ê¸° ìœ„í•´ `Out`ìœ¼ë¡œ ì§€ì •í•˜ë©° **ì“°ê¸°**ì „ìš©ì´ê¸°ë„ í•˜ë‹¤.

---

## ğŸ“‘ NamedPipeClientStream

[NamedPipeClientStream](https://learn.microsoft.com/ko-kr/dotnet/api/system.io.pipes.namedpipeclientstream?view=net-6.0)

NamePipe ì˜ Cline ë¶€ë¶„ì˜ ìƒì„±ìë¥¼ ì‚´í´ë³´ë©´

```csharp
public NamedPipeClientStream (string serverName, string pipeName, System.IO.Pipes.PipeDirection direction);
```

* `string serverName` : ì„œë²„ ì´ë¦„
* `string pipeName` : íŒŒì´í”„ì˜ ì´ë¦„
* `System.IO.Pipes.PipeDirection direction` : íŒŒì´í”„ì˜ ë°©í–¥

`NamedPipeServerStream`ì˜ ìƒì„±ìì™€ ë‹¤ë¥´ê²Œ  `string serverName` ë¼ëŠ” ë³€ìˆ˜ê°€ ìˆëŠ”ë° ì„œë²„ê°€ ë¡œì»¬ ì»´í“¨í„°ì— ìˆëŠ”ê²½ìš°ì—ëŠ” **"."** ìœ¼ë¡œ ë„£ì–´ë„ ë¬´ë°©í•˜ë‹¤!
`string pipeName` ì—ëŠ” ì„œë²„ì™€ **ê°™ì€ íŒŒì´í”„ì˜ ì´ë¦„**ì„ ê°€ì§€ê³  ìˆì–´ì•¼ í•˜ë©° `System.IO.Pipes.PipeDirection direction`ì€ `In`ìœ¼ë¡œ íŒŒì´í”„ê°€ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì„¤ì •ì´ ë˜ë©° **ì½ê¸°** ì „ìš©ì´ê¸°ë„ í•©ë‹ˆë‹¤.

---
## ğŸ–¥ï¸ Named Pipe êµ¬í˜„

### Naed Pipe Write Server

```csharp
public class NamedPipeWriter
{
    public void WriteToPipe(string data)
    {
        using (NamedPipeServerStream pipeServer = new NamedPipeServerStream("Cat", PipeDirection.Out))
        {
            Console.WriteLine("Named Pipe ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ë¥¼ ê¸°ë‹¤ë¦½ë‹ˆë‹¤...");
            pipeServer.WaitForConnection();

            using (StreamWriter writer = new StreamWriter(pipeServer))
            {
                writer.AutoFlush = true;
                writer.WriteLine(data);
                Console.WriteLine("Named Pipe ì„œë²„ê°€ ë°ì´í„°ë¥¼ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.");
            }
        }
    }
}
```


### Named Pipe Read Client

```csharp
public class NamedPipeReader
{
    public string ReadFromPipe()
    {
        using (NamedPipeClientStream pipeClient = new NamedPipeClientStream(".", "Cat", PipeDirection.In))
        {
            Console.WriteLine("Named Pipe í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ì—°ê²° ì¤‘...");
            pipeClient.Connect();

            using (StreamReader reader = new StreamReader(pipeClient))
            {
                string data = reader.ReadLine();
                Console.WriteLine("Named Pipe í´ë¼ì´ì–¸íŠ¸ê°€ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í–ˆìŠµë‹ˆë‹¤.");
                return data;
            }
        }
    }
}
```

**ì“°ê³ / ì½ëŠ”** í´ë˜ìŠ¤ê°€ ìˆìœ¼ë‹ˆ ì´ì œ ì‚¬ìš©í•  í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ìë©´

### Program class
```csharp
class Program
{
    static void Main()
    {
        NamedPipeWriter writer = new NamedPipeWriter();
        NamedPipeReader reader = new NamedPipeReader();

        // ìƒˆë¡œìš´ ìŠ¤ë ˆë“œì—ì„œ Named Pipe ì„œë²„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.
        Task.Run(() =>
        {
            writer.WriteToPipe("Night Mo ë°ì´í„° ì €ì¥!");
        });

        // Named Pipe í´ë¼ì´ì–¸íŠ¸ê°€ ë°ì´í„°ë¥¼ ì½ìŠµë‹ˆë‹¤.
        string data = reader.ReadFromPipe();
        Console.WriteLine($"Received from pipe: {data}");
    }
}
```

### ê²°ê³¼

![image](https://github.com/Gubeommo/TIL/assets/86589565/1453bc91-cbec-4ead-9c84-03477a488bf5)
